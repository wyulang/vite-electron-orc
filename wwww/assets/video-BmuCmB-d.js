import{d as T,u as C,r as N,c as a,a as n,t as f,w as S,v as B,b as p,e as V,f as $,g as U,y as u,h as D,j as L,o as l,F as R,i as I,l as P,m as E}from"./index-Dg9TTGAa.js";import{_ as F}from"./load-iGttVXsz.js";const M={class:"w-all flex pl15 h-all fd-c pr5"},q={class:"flex h-33 pt10 ai-c"},z={class:"fs-13 fb"},A={class:"flex ai-c mt20 jc-c pr10"},J={class:"flex ai-c nodarg h-50 bb-d w-all"},K={key:0,class:"flex ai-c mr10"},O={class:"flex-1 bc-primay nodarg h-all"},G={class:"flex w-all fw"},H=["onClick"],Q={class:"pl10 pr10 fc-fff flex pt7 pb7 fs-16 ai-c ba-5 w-all"},W={class:"abs al10 fs-16 pp5 ba-5 ra-5 ab10 fc-fff"},X=["onClick"],se=T({name:"video",__name:"video",setup(Y){const m=L(),h=C(),e=N({serchText:"三年级数学上册",page:10,list:[],isNext:!1,scroll:0,isBotom:!1});function g(){if(!e.serchText.trim()){u.msg.error("请输入视频资料名称");return}c(10)}function x(s){const t={};return s.replace(/\?|#.*$/,"").replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),(d,i,r,o)=>{t[i]=o}),t}function _(s){h.play.url=s.src}function b(s){let t=JSON.parse(s.heji.compilation_ext);h.heji={compilationId:t.compilation_id,hejiNid:t.hejiNid,frsrcid:s.heji.frsrcid,lid:s.heji.lid,nid:s.heji.nid,referlid:s.heji.referlid,sign:s.heji.sign,page:0,word:s.heji.word,count:s.heji.count,loc:s.loc,number:s.number},setTimeout(()=>{m.push("/video/heji")},10)}function y(s){if(s.isBottom){if(e.isNext||e.scroll>s.top)return;e.scroll=s.top,e.isNext=!0,setTimeout(()=>{c(e.page+10)},10)}}function v(){document.onkeydown=s=>{var t=document.all?window.event:s;t.keyCode==13&&c(10)}}function c(s=10){e.isBotom||(u.spinner.show(),window.storeApi.ipcRenderer("baidu-video",{serchText:e.serchText,page:e.page}).then(t=>{var i,r;if(console.log(t),u.spinner.close(),!String(t)){e.isNext=!0;return}e.isNext=!1,(r=(i=t.data)==null?void 0:i.videoList)!=null&&r.length&&(e.page=s);let d=t.data.videoList.filter(o=>!["xsp","ad","rs"].includes(o.dataType)&&(o.videoSrc||o.mp4b_url)&&!e.list.some(k=>k.vid==o.vid));e.list=[].concat(e.list).concat(d.map(o=>({image:o.imgSrc,src:o.videoSrc||o.mp4b_url,title:o.originTitle,duration:o.duration,vid:o.vid,type:o.dataType,heji:o.dataType=="heji"&&x(decodeURIComponent(o.strongUrlParams.sfUrl))||{},count:o.number||0,loc:o.loc})))}))}function w(){e.serchText="",e.page=1,e.list=[],e.isBotom=!1,e.scroll=0,e.isNext=!1}function j(){c(e.page+10)}return(s,t)=>{const d=D("scroll");return l(),a("div",M,[n("div",q,[n("span",z,"视频资料("+f(e.list.length)+"个视频)",1)]),n("div",A,[n("div",J,[S(n("input",{"onUpdate:modelValue":t[0]||(t[0]=i=>e.serchText=i),onKeydown:v,class:"h-all flex-1 fs-16",placeholder:"在此输入视频资料名称",type:"text"},null,544),[[B,e.serchText]]),e.isLoad?(l(),a("div",K,t[1]||(t[1]=[n("img",{class:"w-20",src:F,alt:""},null,-1)]))):p("",!0),e.serchText?(l(),a("span",{key:1,onClick:w,class:"iconfont hand nodarg icon-qingkong mr15 fs-24"})):p("",!0),n("div",{onClick:g,class:"pl11 pr11 pt6 pb6 ra-5 hand fs-15 fc-fff bc-primary"},t[2]||(t[2]=[n("span",{class:"iconfont fb hand fs-16 mr10 icon-search"},null,-1),V("搜索")])),e.list.length?(l(),a("div",{key:2,onClick:j,class:"pl11 pr11 pt6 pb6 ra-5 hand fs-15 fc-fff ml10 bc-primary"},"下一页")):p("",!0)])]),n("div",O,[$(d,{onScroll:y},{default:U(()=>[n("div",G,[(l(!0),a(R,null,I(e.list,i=>(l(),a("div",{onClick:r=>_(i),style:P({backgroundImage:`url('${i.image}')`}),class:"wb-32 bs-c nodarg hand rel hidden sha-6 mt10 ra-5 mr10 bp-all h-250"},[n("div",Q,f(i.title),1),n("span",W,f(i.duration),1),t[3]||(t[3]=n("span",{class:"iconfont fs-33 icon-mv fc-fff abs absc"},null,-1)),i.type=="heji"?(l(),a("span",{key:0,onClick:E(r=>b(i),["stop"]),class:"abs ar10 pp7 ab10 ba-5 ra-5 fc-fff"},"合集("+f(i.count)+")个",9,X)):p("",!0)],12,H))),256))])]),_:1})]),t[4]||(t[4]=n("div",{class:"h-15"},null,-1))])}}});export{se as default};
